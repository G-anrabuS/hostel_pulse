{% extends 'base.html' %}
{% load static %}

{% block title %}HostelPulse - Dashboard{% endblock %}

{% block extra_head %}
<style>
    .mood-bg-tired {
        background: linear-gradient(to bottom right, rgb(239 246 255), rgb(238 242 255), rgb(243 232 255));
    }

    .dark .mood-bg-tired {
        background: linear-gradient(to bottom right, rgb(30 58 138 / 0.2), rgb(49 46 129 / 0.2), rgb(88 28 135 / 0.2));
    }

    .mood-bg-stressed {
        background: linear-gradient(to bottom right, rgb(254 242 242), rgb(252 231 243), rgb(255 237 213));
    }

    .dark .mood-bg-stressed {
        background: linear-gradient(to bottom right, rgb(127 29 29 / 0.2), rgb(131 24 67 / 0.2), rgb(124 45 18 / 0.2));
    }

    .mood-bg-active {
        background: linear-gradient(to bottom right, rgb(240 253 244), rgb(236 253 245), rgb(240 253 250));
    }

    .dark .mood-bg-active {
        background: linear-gradient(to bottom right, rgb(20 83 45 / 0.2), rgb(6 78 59 / 0.2), rgb(19 78 74 / 0.2));
    }

    .mood-bg-balanced {
        background: linear-gradient(to bottom right, rgb(254 252 232), rgb(254 243 199), rgb(255 237 213));
    }

    .dark .mood-bg-balanced {
        background: linear-gradient(to bottom right, rgb(113 63 18 / 0.2), rgb(120 53 15 / 0.2), rgb(124 45 18 / 0.2));
    }
</style>
{% endblock %}

{% block content %}
<div id="dashboard-container" class="min-h-screen mood-bg-{{ mood }} relative overflow-hidden">
    <!-- Floating Background Elements -->
    <div class="absolute inset-0 opacity-5 pointer-events-none">
        <div class="absolute w-40 h-40 bg-gradient-to-br from-yellow-400 to-amber-500 rounded-full blur-3xl"
            style="top: 8%; left: 8%;"></div>
        <div class="absolute w-32 h-32 bg-gradient-to-br from-orange-400 to-yellow-500 rounded-full blur-2xl"
            style="top: 62%; right: 12%;"></div>
        <div class="absolute w-36 h-36 bg-gradient-to-br from-amber-400 to-orange-500 rounded-full blur-3xl"
            style="bottom: 18%; left: 15%;"></div>
        <div class="absolute w-28 h-28 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full blur-2xl"
            style="bottom: 52%; right: 8%;"></div>
    </div>

    <!-- Header -->
    <header class="bg-white dark:bg-gray-800 shadow-sm p-4">
        <div class="max-w-4xl mx-auto flex items-center justify-between">
            <div class="flex items-center space-x-3">
                {% include 'components/logo.html' with size=40 %}
                <div>
                    <h1 class="text-xl font-bold text-gray-900 dark:text-white">HostelPulse</h1>
                    <p class="text-xs text-gray-500 dark:text-gray-400">Wellness for Students</p>
                </div>
            </div>
            <div class="flex items-center space-x-4">
                <!-- Balance Score Circular Meter -->
                <div class="relative w-16 h-16">
                    <svg class="w-16 h-16 transform -rotate-90" viewBox="0 0 36 36">
                        <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"
                            fill="none" stroke="#e5e7eb" stroke-width="2"></path>
                        <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"
                            fill="none" stroke="#3b82f6" stroke-width="2" stroke-dasharray="{{ balance_score }}, 100">
                        </path>
                    </svg>
                    <div class="absolute inset-0 flex items-center justify-center">
                        <span class="text-sm font-bold text-gray-900 dark:text-white">{{ balance_score }}</span>
                    </div>
                </div>
                <p class="text-sm text-gray-600 dark:text-gray-300 max-w-xs">{{ message }}</p>
                <button onclick="toggleTheme()"
                    class="p-3 rounded-xl bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-700 dark:to-gray-600 hover:from-gray-200 hover:to-gray-300 dark:hover:from-gray-600 dark:hover:to-gray-500 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-110">
                    <span class="text-lg dark:hidden">üåô</span>
                    <span class="text-lg hidden dark:inline">‚òÄÔ∏è</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-4xl mx-auto p-4 space-y-6">
        <!-- Mood Check-in Card -->
        <div
            class="bg-white/90 dark:bg-gray-800/90 backdrop-blur-sm rounded-2xl shadow-xl border border-gray-200/50 dark:border-gray-700/50 p-6 hover:shadow-2xl transition-all duration-300 hover:scale-[1.01]">
            <div class="flex items-center space-x-3 mb-4">
                <div class="p-2 bg-gradient-to-br from-pink-500 to-purple-500 rounded-lg shadow-lg">
                    <span class="text-white text-lg">üí≠</span>
                </div>
                <h2 class="text-lg font-semibold text-gray-900 dark:text-white">How are you feeling right now?</h2>
            </div>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                <button onclick="changeMood('tired')"
                    class="mood-btn p-4 rounded-xl border-2 transition-all duration-200 hover:scale-105 {% if mood == 'tired' %}border-blue-500 bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/30 dark:to-blue-800/30 shadow-lg{% else %}border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 bg-white/50 dark:bg-gray-800/50{% endif %}">
                    <div class="text-2xl mb-2">üò¥</div>
                    <div
                        class="text-sm font-medium capitalize {% if mood == 'tired' %}text-blue-700 dark:text-blue-300{% else %}text-gray-700 dark:text-gray-300{% endif %}">
                        Tired</div>
                </button>
                <button onclick="changeMood('stressed')"
                    class="mood-btn p-4 rounded-xl border-2 transition-all duration-200 hover:scale-105 {% if mood == 'stressed' %}border-blue-500 bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/30 dark:to-blue-800/30 shadow-lg{% else %}border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 bg-white/50 dark:bg-gray-800/50{% endif %}">
                    <div class="text-2xl mb-2">üò∞</div>
                    <div
                        class="text-sm font-medium capitalize {% if mood == 'stressed' %}text-blue-700 dark:text-blue-300{% else %}text-gray-700 dark:text-gray-300{% endif %}">
                        Stressed</div>
                </button>
                <button onclick="changeMood('active')"
                    class="mood-btn p-4 rounded-xl border-2 transition-all duration-200 hover:scale-105 {% if mood == 'active' %}border-blue-500 bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/30 dark:to-blue-800/30 shadow-lg{% else %}border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 bg-white/50 dark:bg-gray-800/50{% endif %}">
                    <div class="text-2xl mb-2">‚ö°</div>
                    <div
                        class="text-sm font-medium capitalize {% if mood == 'active' %}text-blue-700 dark:text-blue-300{% else %}text-gray-700 dark:text-gray-300{% endif %}">
                        Active</div>
                </button>
                <button onclick="changeMood('balanced')"
                    class="mood-btn p-4 rounded-xl border-2 transition-all duration-200 hover:scale-105 {% if mood == 'balanced' %}border-blue-500 bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/30 dark:to-blue-800/30 shadow-lg{% else %}border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 bg-white/50 dark:bg-gray-800/50{% endif %}">
                    <div class="text-2xl mb-2">üòä</div>
                    <div
                        class="text-sm font-medium capitalize {% if mood == 'balanced' %}text-blue-700 dark:text-blue-300{% else %}text-gray-700 dark:text-gray-300{% endif %}">
                        Balanced</div>
                </button>
            </div>
        </div>

        <!-- Gentle Suggestions Card -->
        <div
            class="bg-white/90 dark:bg-gray-800/90 backdrop-blur-sm rounded-2xl shadow-xl border border-gray-200/50 dark:border-gray-700/50 p-6 hover:shadow-2xl transition-all duration-300 hover:scale-[1.01]">
            <div class="flex items-center space-x-3 mb-4">
                <div class="p-2 bg-gradient-to-br from-yellow-500 to-orange-500 rounded-lg shadow-lg">
                    <span class="text-white text-lg">üí°</span>
                </div>
                <h2 class="text-lg font-semibold text-gray-900 dark:text-white">Gentle Suggestions</h2>
            </div>
            <div class="space-y-3">
                {% for suggestion in suggestions %}
                <button
                    class="w-full text-left p-4 bg-gradient-to-r from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 hover:from-blue-100 hover:to-blue-200 dark:hover:from-blue-900/30 dark:hover:to-blue-800/30 rounded-xl transition-all duration-200 text-blue-700 dark:text-blue-300 shadow-sm hover:shadow-md transform hover:scale-[1.02]">
                    {{ suggestion }}
                </button>
                {% endfor %}
            </div>
        </div>

        <!-- Sync Button -->
        <div class="text-center pb-24">
            <button onclick="syncData()" id="sync-btn"
                class="bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 disabled:from-gray-400 disabled:to-gray-500 text-white font-medium py-4 px-8 rounded-xl transition-all duration-200 text-lg shadow-lg hover:shadow-xl transform hover:scale-105">
                <span id="sync-text">üîÑ Sync My Life</span>
            </button>
        </div>
    </main>

    <!-- Bottom Navigation -->
    {% include 'components/bottom_nav.html' with active_page='dashboard' %}
</div>

<script src="{% static 'js/dashboard.js' %}"></script>
{% endblock %}